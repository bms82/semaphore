## Semaphore 이해하기
### 들어가기
자원은 항상 한정적인데, 자원에 대한 접근 관리는 동시 프로그래밍의 기본적인 이슈.
자바는 여러 방법으로 이 접근 권한을 관리하는데 Semaphore는 그 중 하나임. 
Semaphore는 한 자원에 동시에 접근하는 쓰레드 수를 제한함. 

### Semaphore란?
공유 자원에 대한 접근 권한을 관리하는 동시성 도구임. 
자원에 대한 접근을 허가하는 수를 관리함. 쓰레드는 이 권한을 획득하거나 반납함. 

### Semaphore의 주요 특징
* 허가(Permits): 동시에 자원을 접근할 수 있는 쓰레드 수를 결정
* 허가 획득: acquire()를 통해 쓰레드는 허가를 획득함. 허가 수가 0인 경우 쓰레드는 허가 하나가 반환될때까지 블록됨.
* 허가 반납: release()를 통해 반환함. 
* FIFO: 공정성을 위해 FIFO 방법으로 허가를 관리함.

### Semaphore는 언제 사용할까?
* 자원 풀 관리: 고정된 수의 자원 관리(DB연결풀, 쓰레드풀 등)
* 요청 제한: 동시 요청이나 태스크 제한
* 중요 부분: 특정 수의 쓰레드만 동시에 접근해야하는 중요 부분을 보호해야할 경우
* 공동 작업: 동시성을 관리하는 태스트 등으로 다수의 쓰레드를 동기화할 때

### Semaphore는 어떻게 사용하나?
Java 1.5부터 java.util.concurrent 내에 Semaphore 객체가 존재함.
* Semaphore 초기화
* 허가 획득.
* 허가 반납.

### Semaphore 장단점
#### 장점
* 공유자원에 대해 접근하는 쓰레드 수를 지정하여 관리 가능
* 여러 시나리오에서 사용할 수 있음.
* FIFO로 공정하게 자원 접근 순서 정리 가능

#### 단점
* 코드에 복잡성을 더함.
* 허가를 제대로 반납하지 않거나 쓰레드가 허가를 계속해서 유지하는 경우 데드락에 빠질 수 있음.
* 허가 획득/반납은 성능에 추가적인 오버헤드 발생
* 여러 개의 동시 쓰레드 사용시 디버깅이 어려워짐.
* 허가와 관련해서 Semaphore 부분이 길수록 병목 현상이 쉽게 발생함. 

#### SimpleSemaphoreExample은 단순하게 Semaphore 사용하는 예시 안내
* 쓰레드 수는 5로, 20개의 쓰레드가 있지만 한 번에 다섯 개의 쓰레드만 처리됨을 확인할 수 있음.

#### Spring Boot에서 동시 요청을 제한하는 방법으로 사용하기
* SemaphoreApplication을 run하고 /limit으로 요청을 여러 채널에서 보내면서 확인 가능함.
* Semaphore 수는 3으로 그 이상의 요청에 대해서는 제한함.  

